"use strict";var config={enableGeolocationQuestion:["It is necessary to allow your geolocation to use the app.","Please, allow us to use your geolocation.","To use this app, please enable the geolocation."],geolocationNotSupported:"Geolocation is not supported by this browser.",noAirplanes:"No airplanes in your area",noData:"No data",range:200,dataRefreshTime:6e4,baseUrl:"https://public-api.adsbexchange.com/VirtualRadar/",logoBaseUrl:"https://logo.clearbit.com/",checkNetworkOrCORS:"Check your internet connection, and enable CORS in your browser.",errorOccurred:"An error occurred. Please try searching again.",onErrorGetLocation:"Make sure you enabled usage of your geolocation. If you disabled it before, please clear browser settings in browsers top right corner, and try again.",noInternet:"Check yout internet connection.",logo:{"Jet Aviation Flight Services (Malta) Ltd":"jetaviation.com","Jet Time":"jettimes.com","Atlas Air Service AG":"atlasair.com","Travel Service Airlines":"travelserveexports.com","Norwegian Air International":"norwegian.com","Turkmenistan Airlines":"oilgasturkmenistan.com","Royal Jordanian Airlines":"rj.com","Aegean Airlines":"aegeanair.com","Air Serbia":"airserbia.info","Condor Flugdienst":"condor.com"}};function httpGetAsync(e,t,n){var o=new XMLHttpRequest;o.onreadystatechange=function(){4==o.readyState&&(200==o.status?t(JSON.parse(o.responseText)):n(o))},o.open("GET",e,!0),o.send(null)}Array.prototype.sortBy=function(n){return this.sort(function(e,t){return t[n]-e[n]})},function(){var l,t,n=document.getElementById("allowLocation"),o=document.getElementById("deniedLocation"),i=document.getElementById("warning"),d=document.getElementById("list"),a=document.getElementById("loading-spinner"),r=document.getElementById("selected-airplane"),c=document.getElementById("toast"),s=document.getElementById("toast-wrapper");s.setAttribute("style","display: none");var e=document.getElementById("close-airplane"),u=document.getElementById("manufacture"),g=document.getElementById("model"),m=document.getElementById("destination"),f=document.getElementById("origin"),p=document.getElementById("logo");function y(){var e=config.enableGeolocationQuestion.length,t=Math.floor(Math.random()*e);i.innerHTML=config.enableGeolocationQuestion[t],i.classList.add("fadein")}function h(e){t=e,n.removeEventListener("click",B),o.removeEventListener("click",y),document.getElementById("questionWrapper").remove(),document.getElementById("airplanes-container").classList.remove("hidden"),v(),setInterval(v,config.dataRefreshTime)}function v(){b(!0),httpGetAsync(config.baseUrl+"AircraftList.json?lat="+t.coords.latitude+"&lng="+t.coords.longitude+"&fDstL=0&fDstU="+config.range,E,A)}function b(e){var t=e?"block":"none";a.setAttribute("style","display:"+t)}function L(){r.setAttribute("style","display: none;"),window.location.hash=""}function E(e){for(;d.firstChild;)d.firstChild.remove();var t,n=(l=e.acList.sortBy("Alt")).length;if(0<n)for(var o=0;o<n;o++){var i=document.createElement("li"),a=document.createElement("p");a.setAttribute("data-id",l[o].Id);var r=document.createElement("span");r.classList.add("icon-orientation"),r.classList.add(0<(t=l[o].Brng)&&t<180?"west":"east");var c=document.createElement("span");c.innerHTML=l[o].Alt||config.noData,c.classList.add("altitude");var s=document.createElement("span");s.innerHTML=l[o].CNum||config.noData,s.classList.add("code-number"),a.appendChild(r),a.appendChild(c),a.appendChild(s),i.appendChild(a),d.appendChild(i)}else T(config.noData);w(!1),b(!1)}function A(e){b(!1),T(0===e?config.checkNetworkOrCORS:config.errorOccurred)}function w(e){e?(n.setAttribute("disabled",e),o.setAttribute("disabled",e)):(n.removeAttribute("disabled"),o.removeAttribute("disabled"))}function I(e){console.log(e),w(!1),"file:"===window.location.protocol?y():(2===e.code?i.innerHTML=config.onErrorGetLocation+" "+config.noInternet:i.innerHTML=config.onErrorGetLocation,i.classList.add("fadein"))}function B(){navigator.geolocation?(w(!0),navigator.geolocation.getCurrentPosition(h,I)):i.innerHTML=config.geolocationNotSupported}function T(e){c.innerHTML=e,s.setAttribute("style","display: block;"),setTimeout(function(){s.setAttribute("style","display: none;")},3e3)}function k(){var e=window.location.hash.substr(1);if(e&&l){for(var t,n=0,o=l.length;n<o;n++)if(l[n].Id==e){t=l[n];break}if(t&&r){if(r.setAttribute("style","display: block;"),console.log(t),u.innerHTML=t.Man||config.noData,g.innerHTML=t.Mdl||config.noData,f.innerHTML=t.From||config.noData,m.innerHTML=t.To||config.noData,t.Op){var i=t.Op.replace(/\s/g,"")+".com",a=config.logoBaseUrl+(config.logo[t.Op]||i);p.src=a}}else L()}else L()}n.addEventListener("click",B),o.addEventListener("click",y),r.addEventListener("click",function(e){"selected-airplane"==e.target.id&&L()}),e.addEventListener("click",L),window.addEventListener("hashchange",k),d.addEventListener("click",function(e){var t=e.target.dataset.id||e.target.parentElement.dataset.id;window.location.hash=t},!1),k()}();