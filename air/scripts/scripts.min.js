"use strict";var config={enableGeolocationQuestion:["It is necessary to allow your geolocation to use the app.","Please, allow us to use your geolocation.","To use this app, please enable the geolocation."],geolocationNotSupported:"Geolocation is not supported by this browser.",noAirplanes:"No airplanes in your area",noData:"No data",range:200,dataRefreshTime:6e4,baseUrl:"https://public-api.adsbexchange.com/VirtualRadar/",logoBaseUrl:"https://logo.clearbit.com/",checkNetworkOrCORS:"Check your internet connection, and enable CORS in your browser.",errorOccurred:"An error occurred. Please try searching again.",logo:{"Jet Aviation Flight Services (Malta) Ltd":"jetaviation.com","Jet Time":"jettimes.com","Atlas Air Service AG":"atlasair.com","Travel Service Airlines":"travelserveexports.com","Norwegian Air International":"norwegian.com","Turkmenistan Airlines":"oilgasturkmenistan.com","Royal Jordanian Airlines":"rj.com","Aegean Airlines":"aegeanair.com","Air Serbia":"airserbia.info","Condor Flugdienst":"condor.com"}};function httpGetAsync(e,t,n){var o=new XMLHttpRequest;o.onreadystatechange=function(){4==o.readyState&&(200==o.status?t(JSON.parse(o.responseText)):n(o.status))},o.open("GET",e,!0),o.send(null)}Array.prototype.sortBy=function(n){return this.sort(function(e,t){return t[n]-e[n]})},function(){var s,t,n=document.getElementById("allowLocation"),o=document.getElementById("deniedLocation"),a=document.getElementById("warning"),d=document.getElementById("list"),i=document.getElementById("loading-spinner"),r=document.getElementById("selected-airplane"),e=document.getElementById("close-airplane"),c=document.getElementById("manufacture"),l=document.getElementById("model"),u=document.getElementById("destination"),g=document.getElementById("origin"),m=document.getElementById("logo");function p(){var e=config.enableGeolocationQuestion.length,t=Math.floor(Math.random()*e);a.innerHTML=config.enableGeolocationQuestion[t],a.classList.add("fadein")}function f(e){t=e,n.removeEventListener("click",w),o.removeEventListener("click",p),document.getElementById("questionWrapper").remove(),document.getElementById("airplanes-container").classList.remove("hidden"),h(),setInterval(h,config.dataRefreshTime)}function h(){v(!0),httpGetAsync(config.baseUrl+"AircraftList.json?lat="+t.coords.latitude+"&lng="+t.coords.longitude+"&fDstL=0&fDstU="+config.range,b,E)}function v(e){var t=e?"block":"none";i.setAttribute("style","display:"+t)}function y(){r.setAttribute("style","display: hidden;"),window.location.hash=""}function b(e){for(;d.firstChild;)d.firstChild.remove();var t,n=(s=e.acList.sortBy("Alt")).length;if(0<n)for(var o=0;o<n;o++){var a=document.createElement("li");(l=document.createElement("p")).setAttribute("data-id",s[o].Id);var i=document.createElement("span");i.classList.add("icon-orientation"),i.classList.add(0<(t=s[o].Brng)&&t<180?"west":"east");var r=document.createElement("span");r.innerHTML=s[o].Alt||config.noData,r.classList.add("altitude");var c=document.createElement("span");c.innerHTML=s[o].CNum||config.noData,c.classList.add("code-number"),l.appendChild(i),l.appendChild(r),l.appendChild(c),a.appendChild(l),d.appendChild(a)}else{var l;a=document.createElement("li");(l=document.createElement("p")).innerHTML=config.noAirplanes,a.appendChild(l),d.appendChild(a)}L(!1),v(!1)}function E(e){v(!1),0===e?alert(config.checkNetworkOrCORS):alert(config.errorOccurred)}function L(e){e?(n.setAttribute("disabled",e),o.setAttribute("disabled",e)):(n.removeAttribute("disabled"),o.removeAttribute("disabled"))}function A(e){L(!1),2===e.code?alert(config.checkNetworkOrCORS):p()}function w(){navigator.geolocation?(L(!0),navigator.geolocation.getCurrentPosition(f,A)):a.innerHTML=config.geolocationNotSupported}function k(){var e=window.location.hash.substr(1);if(e&&s){for(var t,n=0,o=s.length;n<o;n++)if(s[n].Id==e){t=s[n];break}if(t&&r){if(r.setAttribute("style","display: block;"),console.log(t),c.innerHTML=t.Man||config.noData,l.innerHTML=t.Mdl||config.noData,g.innerHTML=t.From||config.noData,u.innerHTML=t.To||config.noData,t.Op){var a=t.Op.replace(/\s/g,"")+".com",i=config.logoBaseUrl+(config.logo[t.Op]||a);m.src=i}}else y()}else y()}n.addEventListener("click",w),o.addEventListener("click",p),r.addEventListener("click",function(e){"selected-airplane"==e.target.id&&y()}),e.addEventListener("click",y),window.addEventListener("hashchange",k),d.addEventListener("click",function(e){var t=e.target.dataset.id||e.target.parentElement.dataset.id;window.location.hash=t},!1),k()}();